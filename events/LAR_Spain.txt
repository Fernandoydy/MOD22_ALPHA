add_namespace = lar_spain 

# Election of 1936 - La Resistance Edition

# Spanish Civil War - La Resistance Edition

# Mission Generator simulating Republican government working against the Nationalists

# Spain - Nationalists out of focuses to take, have to 'lay low' for a while
country_event = {
	id = lar_spain.18
	title = lar_spain.18.t
	desc = lar_spain.18.desc
	picture = GFX_report_event_spr_nationalist_soldiers
	
	trigger = {
		tag = SPR
		
		NOT = { has_global_flag = spanish_civil_war }
		NOT = { has_global_flag = scw_over }
		date > 1936.8.10
	}

	mean_time_to_happen = {
		days = 2
	}

	fire_only_once = yes
	
	option = {
		name = lar_spain.18.a
		add_ideas = SPA_awaiting_the_rebellion
		custom_effect_tooltip = lar_spain.18.a_tt
	}
}

# Reassert American Dominance - Event for American nations
country_event = {
	id = lar_spain.19
	title = lar_spain.19.t
	desc = lar_spain.19.desc
	picture = GFX_report_event_generic_parliament
	
	is_triggered_only = yes
	
	option = { # Accept
		name = lar_spain.19.a
		ai_chance = {
			base = 50
			modifier = {
				factor = 0
				strength_ratio = { tag = FROM ratio > 1 }
			}
		}
		effect_tooltip = {
			FROM = { puppet = ROOT }
		}
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.20 hours = 18 random_hours = 6 }
			}
		}
	}

	option = { # Decline
		name = lar_spain.19.b
		ai_chance = {
			base = 50
			modifier = {
				factor = 0.8
				strength_ratio = { tag = FROM ratio < 0.5 }
			}
			modifier = {
				factor = 0.8
				has_opinion = { target = FROM value > 99 }
			}
			modifier = {
				factor = 0.8
				strength_ratio = { tag = FROM ratio < 0.3 }
			}
			modifier = {
				factor = 0.8
				strength_ratio = { tag = FROM ratio < 0.2 }
			}
			modifier = {
				factor = 0.5
				strength_ratio = { tag = FROM ratio < 0.1 }
			}
		}
		effect_tooltip = {
			FROM = {
				create_wargoal = {
				    type = puppet_wargoal_focus
				    target = ROOT
				}
			}
		}
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.21 hours = 18 random_hours = 6 }
			}
		}
	}
}

# Reassert American Dominance - Notification event for Spain - Target Accepted
country_event = {
	id = lar_spain.20
	title = lar_spain.20.t
	desc = lar_spain.20.desc
	picture = GFX_report_event_generic_parliament
	
	is_triggered_only = yes
	
	option = { # Ok
		name = lar_spain.20.a
		puppet = FROM
	}
}

# Reassert American Dominance - Notification event for Spain - Target Declined
country_event = {
	id = lar_spain.21
	title = lar_spain.21.t
	desc = lar_spain.21.desc
	picture = GFX_report_event_generic_parliament
	
	is_triggered_only = yes
	
	option = { # Damn
		name = lar_spain.21.a
		create_wargoal = {
		    type = puppet_wargoal_focus
		    target = FROM
		}
	}
}

# Portuguese Aid - Event for Portugal
country_event = {
	id = lar_spain.22
	title = lar_spain.22.t
	desc = lar_spain.22.desc
	picture = GFX_report_event_generic_read_write
	
	is_triggered_only = yes
	
	option = { # Accept
		name = lar_spain.22.a
		ai_chance = {
			base = 50
		}
		add_manpower = -20000
		effect_tooltip = {
			FROM = { add_manpower = 20000 }
		}
		add_timed_idea = { idea = SPA_spanish_civil_war_commitments days = 730 }
		add_opinion_modifier = { target = ROOT modifier = SPA_spanish_civil_war_commitments }
		add_ai_strategy = {
			type = send_volunteers_desire
			id = SPA
			value = 200
		}
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.23 hours = 18 random_hours = 6 }
			}
		}
	}

	option = { # Decline
		name = lar_spain.22.b
		ai_chance = {
			base = 50
			modifier = {
				factor = 0.5
				has_opinion = { target = FROM value > 99 }
			}
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.24 hours = 18 random_hours = 6 }
			}
		}
	}
}

# Portuguese Aid - Event for Spain - POR accepted
country_event = {
	id = lar_spain.23
	title = lar_spain.23.t
	desc = lar_spain.23.desc
	picture = GFX_report_event_soldiers_marching
	
	is_triggered_only = yes
	
	option = { # OK
		name = lar_spain.23.a
		effect_tooltip = {
			POR = {
				add_timed_idea = { idea = SPA_spanish_civil_war_commitments days = 730 }
				add_opinion_modifier = { target = ROOT modifier = SPA_spanish_civil_war_commitments }
			}
		}
		add_manpower = 20000
	}
}

# Portuguese Aid - Event for Spain - POR declined
country_event = {
	id = lar_spain.24
	title = lar_spain.24.t
	desc = lar_spain.24.desc
	picture = GFX_report_event_generic_read_write
	
	is_triggered_only = yes
	
	option = { # OK
		name = lar_spain.24.a
	}
}

# Iberian Pact - Event for Portugal
country_event = {
	id = lar_spain.25
	title = lar_spain.25.t
	desc = lar_spain.25.desc
	picture = GFX_report_event_generic_parliament
	
	is_triggered_only = yes
	
	option = { # Accept
		name = lar_spain.25.a
		ai_chance = {
			base = 50
			modifier = {
				factor = 0
			}
		}
		custom_effect_tooltip = SPA_the_iberian_pact_tt
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.26 hours = 18 random_hours = 6 }
			}
		}
		if= { #If Portugal is in faction, Spain will join
			limit = {
				is_in_faction = yes
				FROM = { is_in_faction = no }
			}
			effect_tooltip = {
				random_other_country = {
					limit = {
						is_in_faction_with = ROOT
						is_faction_leader = yes
					}
					add_to_faction = FROM
				}
			}
		}
		else_if = { #If Spain is in faction, Portugal will join
			limit = {
				is_in_faction = no
				FROM = { is_in_faction = yes }
			}
			random_other_country = {
				limit = {
					is_in_faction_with = FROM
					is_faction_leader = yes
				}
				add_to_faction = ROOT
			}
		}
		else_if = { #If Spain and Portugal are in different factions, both will leave their faction
			limit = {
				is_in_faction = yes
				FROM = { is_in_faction = yes }
				NOT = { is_in_faction_with = FROM }
			}
			effect_tooltip = {
				leave_faction = yes
				FROM = { leave_faction = yes }
			}
		}
	}

	option = { # Decline
		name = lar_spain.25.b
		ai_chance = {
			base = 50
			modifier = {
				factor = 0.5
				has_opinion = { target = FROM value > 99 }
			}
		}
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.27 hours = 18 random_hours = 6 }
			}
		}
	}
}

# Iberian Pact - Event for Spain - POR accepted
country_event = {
	id = lar_spain.26
	title = lar_spain.25.t
	desc = lar_spain.26.desc
	picture = GFX_report_event_generic_sign_treaty1
	
	is_triggered_only = yes
	
	option = { # OK
		name = lar_spain.26.a
		custom_effect_tooltip = SPA_the_iberian_pact_tt
		if= { #If Spain is in faction, Portugal will join
			limit = {
				is_in_faction = yes
				FROM = { is_in_faction = no }
			}
			effect_tooltip = {
				random_other_country = {
					limit = {
						is_in_faction_with = ROOT
						is_faction_leader = yes
					}
					add_to_faction = FROM
				}
			}
		}
		else_if = { #If Portugal is in faction, Spain will join
			limit = {
				is_in_faction = no
				FROM = { is_in_faction = yes }
			}
			random_other_country = {
				limit = {
					is_in_faction_with = FROM
					is_faction_leader = yes
				}
				add_to_faction = ROOT
			}
		}
		else_if = { #If Spain and Portugal are in different factions, both will leave their faction
			limit = {
				is_in_faction = yes
				FROM = { is_in_faction = yes }
				NOT = { is_in_faction_with = FROM }
			}
			leave_faction = yes
			FROM = { leave_faction = yes }
		}
		hidden_effect = {
			FROM = { set_country_flag = SPA_iberian_pact }
			set_country_flag = SPA_iberian_pact
		}
	}
}

# Iberian Pact - Event for Spain - POR declined
country_event = {
	id = lar_spain.27
	title = lar_spain.25.t
	desc = lar_spain.27.desc
	picture = GFX_report_event_generic_sign_treaty1
	
	is_triggered_only = yes
	
	option = { # OK
		name = lar_spain.27.a
	}
}

# Iberian Pact - Other party has joined a faction, we must uphold our end of the bargain!
country_event = {
	id = lar_spain.28
	title = lar_spain.28.t
	desc = lar_spain.28.desc
	picture = GFX_report_event_generic_parliament
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			random_other_country = {
				limit = {
					has_country_flag = SPA_iberian_pact_invitee
				}
				save_event_target_as = iberian_pact_invitee
			}
			random_other_country = {
				limit = {
					has_country_flag = SPA_iberian_pact_faction_leader
				}
				add_to_faction = ROOT
			}
		}
	}
	
	option = { # OK
		name = lar_spain.28.a
		effect_tooltip = {
			random_other_country = {
				limit = {
					is_in_faction_with = event_target:iberian_pact_invitee
					is_faction_leader = yes
				}
				add_to_faction = ROOT
			}
		}
	}
}

# Iberian Pact - Other party has joined the war, we must uphold our end of the bargain!
country_event = {
	id = lar_spain.29
	title = lar_spain.28.t
	desc = lar_spain.29.desc
	picture = GFX_report_event_generic_parliament

	is_triggered_only = yes
	
	option = { # OK
		name = lar_spain.28.a
		random_other_country = {
			limit = {
				has_war_with = event_target:iberian_pact_war_target
				if = {
					limit = {
						any_country = {
							has_country_flag = SPA_iberian_pact_enemy_flag
						}
					}
					has_country_flag = SPA_iberian_pact_enemy_flag
				}
			}
			random_other_country = {
				limit = {
					has_country_flag = SPA_iberian_pact
					has_war_with = PREV
				}
				ROOT = {
					add_to_war = { 
					    targeted_alliance = PREV
					    enemy = PREV.PREV
					    hostility_reason = asked_to_join
					}
				}
			}
		}
	}
}

# Latin Bloc - Event for invitees
country_event = {
	id = lar_spain.30
	title = lar_spain.30.t
	desc = lar_spain.30.desc
	picture = GFX_report_event_generic_read_write
	
	is_triggered_only = yes
	
	option = { # Accept
		name = lar_spain.30.a
		ai_chance = {
			base = 50
			modifier = {
				factor = 0
				has_government = democratic
				FROM = { has_government = fascism }
			}
			modifier = {
				factor = 0
				has_government = communism
			}
		}
		effect_tooltip = {
			FROM = {
				add_to_faction = ROOT
			}
		}
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.31 hours = 18 random_hours = 6 }
			}
			add_ai_strategy = {
				type = alliance
				id = FROM
				value = 200
			}
		}
	}

	option = { # Decline
		name = lar_spain.30.b
		ai_chance = {
			base = 50
			modifier = {
				factor = 0.5
				has_opinion = { target = FROM value > 99 }
			}
			modifier = {
				factor = 0
				has_government = FROM
			}
		}
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.32 hours = 18 random_hours = 6 }
			}
		}
	}
}

# Latin Bloc - Event for Spain - FROM accepted
country_event = {
	id = lar_spain.31
	title = lar_spain.30.t
	desc = lar_spain.31.desc
	picture = GFX_report_event_generic_sign_treaty2
	
	is_triggered_only = yes
	
	option = { # OK
		name = lar_spain.31.a
		add_to_faction = FROM
	}
}

# Latin Bloc - Event for Spain - FROM declined
country_event = {
	id = lar_spain.32
	title = lar_spain.30.t
	desc = lar_spain.32.desc
	picture = GFX_report_event_generic_read_write
	
	is_triggered_only = yes
	
	option = { # OK
		name = lar_spain.32.a
	}
}

# Spain - Contact the Union Militar Espanola
country_event = {
	id = lar_spain.33
	title = lar_spain.33.t
	desc = lar_spain.33.desc
	picture = GFX_report_event_spr_carlists2
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			random_owned_state = {
				limit = {
					is_core_of = ROOT
					is_controlled_by = ROOT
					NOT = {
						state = 177
						state = 178
					}
					NOT = { has_state_flag = SPA_carlist_cell_flag }
				}
				set_state_flag = union_militar_temp_flag_1
				save_event_target_as = union_militar_target_state_1
			}
			random_owned_state = {
				limit = {
					is_core_of = ROOT
					is_controlled_by = ROOT
					NOT = {
						state = 177
						state = 178
					}
					NOT = { has_state_flag = SPA_carlist_cell_flag }
					NOT = { has_state_flag = union_militar_temp_flag_1 }
				}
				set_state_flag = union_militar_temp_flag_2
				save_event_target_as = union_militar_target_state_2
			}
			random_owned_state = {
				limit = {
					is_core_of = ROOT
					is_controlled_by = ROOT
					NOT = {
						state = 177
						state = 178
					}
					NOT = { has_state_flag = SPA_carlist_cell_flag }
					NOT = { has_state_flag = union_militar_temp_flag_1 }
					NOT = { has_state_flag = union_militar_temp_flag_2 }
				}
				set_state_flag = union_militar_temp_flag_3
				save_event_target_as = union_militar_target_state_3
			}
		}
	}
	
	option = { # Choose First State
		name = lar_spain.33.a
		trigger = {
			any_owned_state = {
				has_state_flag = union_militar_temp_flag_1
			}
		}
		random_owned_state = {
			limit = {
				has_state_flag = union_militar_temp_flag_1
			}
			custom_effect_tooltip = lar_spain.33_tt
			hidden_effect = {
				set_state_flag = SPA_union_militar_flag
			}
		}
	}

	option = { # Choose Second State
		name = lar_spain.33.b
		trigger = {
			any_owned_state = {
				has_state_flag = union_militar_temp_flag_2
			}
		}
		random_owned_state = {
			limit = {
				has_state_flag = union_militar_temp_flag_2
			}
			custom_effect_tooltip = lar_spain.33_tt
			hidden_effect = {
				set_state_flag = SPA_union_militar_flag
			}
		}
	}

	option = { # Choose Third State
		name = lar_spain.33.c
		trigger = {
			any_owned_state = {
				has_state_flag = union_militar_temp_flag_3
			}
		}
		random_owned_state = {
			limit = {
				has_state_flag = union_militar_temp_flag_3
			}
			custom_effect_tooltip = lar_spain.33_tt
			hidden_effect = {
				set_state_flag = SPA_union_militar_flag
			}
		}
	}
}

# Spain - Settle the Succession Question
country_event = {
	id = lar_spain.34
	title = lar_spain.34.t
	desc = lar_spain.34.desc
	picture = GFX_report_event_generic_parliament
	
	is_triggered_only = yes
	
	option = { # Choose first King
		name = lar_spain.34.a
		ai_chance = {
			base = 66
		}
		set_country_flag = SPB_xavier_king
		custom_effect_tooltip = lar_spain.34.a_tt
	}

	option = { # Choose second King
		name = lar_spain.34.b
		ai_chance = {
			base = 34
		}
		custom_effect_tooltip = lar_spain.34.b_tt
	}
}

# Spain - Restore the Monarchy - ### DEPRECATED, replaced by News Event ###
country_event = {
	id = lar_spain.35
	title = lar_spain.35.t
	desc = lar_spain.35.desc
	picture = GFX_report_event_royal_parade
	
	is_triggered_only = yes
	
	option = { # Establish Monarchy
		name = lar_spain.35.a
		drop_cosmetic_tag = yes
		set_cosmetic_tag = SPB_kingdom
		if = {
			limit = {
				has_country_flag = SPB_xavier_king
			}
			create_country_leader = {
				name = "Javier I"
				desc = "POLITICS_JAVIER_I_DESC"
				picture = "GFX_portrait_SPA_xavier_of_bourbon_parma"
				expire = "1965.1.1"
				ideology = despotism
				traits = {
					the_sacred_king
				}
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = SPB_xavier_king }
				NOT = { has_global_flag = SPB_alfonso_xiii_dead }
			}
			create_country_leader = {
				name = "Alfonso XIII"
				desc = "POLITICS_ALFONSO_XIII_DESC"
				picture = "GFX_portrait_SPA_alfonso_xiii"
				expire = "1965.1.1"
				ideology = despotism
				traits = {
					disgraced_monarch
				}
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = SPB_xavier_king }
				has_global_flag = SPB_alfonso_xiii_dead
			}
			create_country_leader = {
				name = "Jaime IV"
				desc = "POLITICS_JAIME_IV_DESC"
				picture = "GFX_portrait_fra_infante_jaime"
				expire = "1965.1.1"
				ideology = despotism
				traits = {
					the_legitimist
				}
			}
		}
	}
}

# Tangiers Enclave - Event for UK
country_event = {
	id = lar_spain.36
	title = lar_spain.36.t
	desc = lar_spain.36.desc
	picture = GFX_report_event_spr_occupation_of_tangiers
	
	is_triggered_only = yes
	
	option = { # Protest
		name = lar_spain.36.a
		ai_chance = {
			base = 34
			modifier = {
				factor = 3
				has_war = no
			}
			modifier = {
				factor = 2
				has_government = democratic
			}
			modifier = {
				factor = 5
				strength_ratio = {
				    tag = FROM
				    ratio > 5
				}
			}
			modifier = {
				factor = 2
				strength_ratio = {
				    tag = FROM
				    ratio > 3
				}
			}
			modifier = {
				factor = 0.5
				strength_ratio = {
				    tag = FROM
				    ratio < 2
				}
			}
			modifier = {
				factor = 0.5
				NOT = { has_political_power > 100 }
			}
			modifier = {
				factor = 0
				strength_ratio = {
				    tag = FROM
				    ratio < 1
				}
			}
			modifier = {
				factor = 0
				is_in_faction_with = FROM
			}
		}
		add_political_power = -200
		custom_effect_tooltip = lar_spain.36_tt
		effect_tooltip = {
			create_wargoal = {
			    type = topple_government
			    target = FROM
			}
		}
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.37 hours = 18 random_hours = 6 }
			}
		}
	}

	option = { # Let it slide
		name = lar_spain.36.b
		ai_chance = {
			base = 66
			modifier = {
				factor = 10
				has_war = yes
			}
			modifier = {
				factor = 5
				has_government = fascism
			}
			modifier = {
				factor = 10
				surrender_progress > 0.1
			}
		}
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.38 hours = 18 random_hours = 6 }
			}
		}
	}
}

# Tangiers Enclave - Event for Spain - UK protested
country_event = {
	id = lar_spain.37
	title = lar_spain.36.t
	desc = lar_spain.37.desc
	picture = GFX_report_event_spr_occupation_of_tangiers
	
	is_triggered_only = yes
	
	option = { # OK
		name = lar_spain.37.a
		ai_chance = {
			base = 50
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		FROM = {
			create_wargoal = {
			    type = topple_government
			    target = ROOT
			}
		}
		290 = {
			add_extra_state_shared_building_slots = 3
			add_building_construction = {
				type = industrial_complex
				level = 2
				instant_build = yes
			}
		}
	}

	option = { # We must back down
		name = lar_spain.37.b
		ai_chance = {
			base = 50
			modifier = {
				factor = 0.5
				strength_ratio = {
				    tag = FROM
				    ratio > 0.6
				}
			}
		}
	}
}

# Tangiers Enclave - Event for Spain - UK let it slide
country_event = {
	id = lar_spain.38
	title = lar_spain.36.t
	desc = lar_spain.38.desc
	picture = GFX_report_event_spr_occupation_of_tangiers
	
	is_triggered_only = yes
	
	option = { # OK
		name = lar_spain.38.a
		290 = {
			add_extra_state_shared_building_slots = 3
			add_building_construction = {
				type = industrial_complex
				level = 2
				instant_build = yes
			}
		}
	}
}

# Demand French North Africa - Event for France
country_event = {
	id = lar_spain.39
	title = lar_spain.39.t
	desc = lar_spain.39.desc
	picture = GFX_report_event_generic_parliament
	
	is_triggered_only = yes
	
	option = { # Accept
		name = lar_spain.39.a
		ai_chance = {
			base = 50
			modifier = {
				factor = 0
				strength_ratio = { tag = FROM ratio > 1 }
			}
			modifier = {
				factor = 5
				NOT = { has_war_with = FROM }
				has_war = yes
			}
		}
		effect_tooltip = {
			FROM = {
				transfer_state = 461
				transfer_state = 462
				transfer_state = 459
				transfer_state = 460
				transfer_state = 513
				transfer_state = 514
				transfer_state = 458
				transfer_state = 665
			}
		}
		hidden_effect = {
			set_country_flag = surrendered_french_north_africa
			FROM = {
				country_event = { id = lar_spain.40 hours = 18 random_hours = 6 }
			}
			news_event = { id = lar_news.14 days = 2 }
		}
	}

	option = { # Decline
		name = lar_spain.39.b
		ai_chance = {
			base = 50
			modifier = {
				factor = 0.8
				strength_ratio = { tag = FROM ratio < 0.5 }
			}
			modifier = {
				factor = 0.8
				has_opinion = { target = FROM value > 99 }
			}
			modifier = {
				factor = 0.8
				strength_ratio = { tag = FROM ratio < 0.3 }
			}
			modifier = {
				factor = 0.8
				strength_ratio = { tag = FROM ratio < 0.2 }
			}
			modifier = {
				factor = 0
				strength_ratio = { tag = FROM ratio < 0.1 }
			}
		}
		effect_tooltip = {
			FROM = {
				add_state_claim = 461
				add_state_claim = 462
				add_state_claim = 459
				add_state_claim = 460
				add_state_claim = 513
				add_state_claim = 514
				add_state_claim = 458
				add_state_claim = 665
				create_wargoal = {
					type = take_state_focus
					target = ROOT
					generator = { 461 462 459 460 513 514 458 665 }
					expire = 0
				}
			}
		}
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.41 hours = 18 random_hours = 6 }
			}
		}
	}
}

# Demand French North Africa - Event for Spain - France accepted
country_event = {
	id = lar_spain.40
	title = lar_spain.40.t
	desc = lar_spain.40.desc
	picture = GFX_report_event_generic_sign_treaty3
	
	is_triggered_only = yes
	
	option = { # Ok
		name = lar_spain.40.a
		transfer_state = 461
		transfer_state = 462
		transfer_state = 459
		transfer_state = 460
		transfer_state = 513
		transfer_state = 514
		transfer_state = 458
		transfer_state = 665
	}
}

# Demand French North Africa - Event for Spain - France declined
country_event = {
	id = lar_spain.41
	title = lar_spain.41.t
	desc = lar_spain.41.desc
	picture = GFX_report_event_generic_read_write
	
	is_triggered_only = yes
	
	option = { # Damn
		name = lar_spain.41.a
		add_state_claim = 461
		add_state_claim = 462
		add_state_claim = 459
		add_state_claim = 460
		add_state_claim = 513
		add_state_claim = 514
		add_state_claim = 458
		add_state_claim = 665
		create_wargoal = {
			type = take_state_focus
			target = FROM
			generator = { 461 462 459 460 513 514 458 665 }
			expire = 0
		}
	}
}

# Claim the French Throne - Event for France
country_event = {
	id = lar_spain.42
	title = lar_spain.42.t
	desc = lar_spain.42.desc
	picture = GFX_report_event_generic_parliament
	
	is_triggered_only = yes
	
	option = { # Accept
		name = lar_spain.42.a
		ai_chance = {
			base = 5
			modifier = {
				factor = 0
				has_war = no
				strength_ratio = { tag = FROM ratio > 0.5 }
			}
		}
		effect_tooltip = {
			FROM = {
				annex_country = { target = ROOT transfer_troops = yes }
			}
		}
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.43 hours = 18 random_hours = 6 }
			}
			news_event = { id = lar_news.15 days = 2 }
		}
		custom_effect_tooltip = GAME_OVER_TT
	}

	option = { # Decline
		name = lar_spain.42.b
		ai_chance = {
			base = 95
			modifier = {
				factor = 0.8
				NOT = { has_war_with = FROM }
				has_war = yes
				surrender_progress > 0.1
			}
			modifier = {
				factor = 0.5
				NOT = { has_war_with = FROM }
				has_war = yes
				surrender_progress > 0.3
			}
			modifier = {
				factor = 0.5
				strength_ratio = { tag = FROM ratio < 0.2 }
			}
			modifier = {
				factor = 0.2
				NOT = { has_war_with = FROM }
				has_war = yes
				surrender_progress > 0.5
			}
		}
		effect_tooltip = {
			FROM = {
				create_wargoal = {
					type = annex_everything
					target = ROOT
				}
			}
		}
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.44 hours = 18 random_hours = 6 }
			}
		}
	}
}

# Claim the French Throne - Event for Spain - France accepted
country_event = {
	id = lar_spain.43
	title = lar_spain.43.t
	desc = lar_spain.43.desc
	picture = GFX_report_event_generic_parliament
	
	is_triggered_only = yes
	
	option = { # Ok
		name = lar_spain.43.a
		puppet = FROM
		custom_effect_tooltip = lar_spain.43_tt
		hidden_effect = { country_event = { id = lar_spain.79 days = 7 random_days = 7 } }
	}
}

# Claim the French Throne - Event for Spain - France declined
country_event = {
	id = lar_spain.44
	title = lar_spain.44.t
	desc = lar_spain.44.desc
	picture = GFX_report_event_read_write
	
	is_triggered_only = yes
	
	option = { # Damn
		name = lar_spain.44.a
		create_wargoal = {
			type = annex_everything
			target = FROM
		}
	}
}

# Iberian Union - Event for Portugal
country_event = {
	id = lar_spain.45
	title = lar_spain.45.t
	desc = lar_spain.45.desc
	picture = GFX_report_event_generic_parliament
	
	is_triggered_only = yes
	
	option = { # Accept
		name = lar_spain.45.a
		ai_chance = {
			base = 5
			modifier = {
				factor = 0
				has_war = no
				strength_ratio = { tag = FROM ratio > 0.5 }
				NOT = { is_puppet_of = FROM }
			}
			modifier = {
				factor = 5
				has_opinion = { target = FROM value > 99 }
			}
		}
		effect_tooltip = {
			FROM = {
				annex_country = { target = ROOT transfer_troops = yes }
			}
		}
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.46 hours = 18 random_hours = 6 }
			}
			news_event = { id = lar_news.16 days = 2 }
		}
		custom_effect_tooltip = GAME_OVER_TT
	}

	option = { # Decline
		name = lar_spain.45.b
		ai_chance = {
			base = 95
			modifier = {
				factor = 0.8
				NOT = { has_war_with = FROM }
				has_war = yes
				surrender_progress > 0.1
			}
			modifier = {
				factor = 0.5
				NOT = { has_war_with = FROM }
				has_war = yes
				surrender_progress > 0.3
			}
			modifier = {
				factor = 0.5
				strength_ratio = { tag = FROM ratio < 0.2 }
			}
			modifier = {
				factor = 0
				OR = {
					AND = {
						NOT = { has_war_with = FROM }
						has_war = yes
						surrender_progress > 0.5
					}
					is_puppet_of = FROM
				}
			}
		}
		effect_tooltip = {
			FROM = {
				create_wargoal = {
					type = annex_everything
					target = ROOT
				}
			}
		}
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.47 hours = 18 random_hours = 6 }
			}
		}
	}
}

# Iberian Union - Event for Spain - Portugal Accepted
country_event = {
	id = lar_spain.46
	title = lar_spain.46.t
	desc = lar_spain.46.desc
	picture = GFX_report_event_generic_sign_treaty3
	
	is_triggered_only = yes
	
	option = { # Ok
		name = lar_spain.46.a
		set_cosmetic_tag = ESU_POR_unified
		every_state = {
			limit = {
				is_core_of = POR
			}
			add_core_of = ROOT
		}
		annex_country = { target = FROM transfer_troops = yes }
	}
}

# Iberian Union - Event for Spain - Portugal Declined
country_event = {
	id = lar_spain.47
	title = lar_spain.47.t
	desc = lar_spain.47.desc
	picture = GFX_report_event_generic_sign_treaty2
	
	is_triggered_only = yes
	
	option = { # Damn
		name = lar_spain.47.a
		create_wargoal = {
			type = annex_everything
			target = FROM
		}
	}
}

# Portuguese Anarchism - Event for Portugal
country_event = {
	id = lar_spain.48
	title = lar_spain.48.t
	desc = lar_spain.48.desc
	picture = GFX_report_event_spr_anarchist_uprising
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			random_owned_state = {
				limit = {
					any_neighbor_state = {
						is_fully_controlled_by = SPC
					}
				}
				set_state_flag = SPC_portuguese_anarchism_state
			}
			set_global_flag = SPR_portuguese_anarchism_flag
		}
	}
	
	option = { # Ok :'(
		name = lar_spain.48.a
		hidden_effect = {
			start_civil_war = {
			    ideology = communism
			    size = 0.1
			    states_filter = { 
			        has_state_flag = SPC_portuguese_anarchism_state
			    }
			    keep_unit_leaders_trigger = {
			    	always = yes
			    }
			}
			random_country = {
				limit = {
					original_tag = POR
					has_government = communism
					NOT = { tag = ROOT }
				}
				set_politics = {
					ruling_party = neutrality
				}
				set_political_party = {
				    ideology = neutrality
				    popularity = 100
				}
				set_party_name = { ideology = neutrality long_name = SPR_neutrality_anarchism_party_long name = SPR_neutrality_anarchism_party }
				set_cosmetic_tag = SPR_POR_anarchism
				set_country_flag = SPR_portuguese_anarchism_flag
				retire_country_leader = yes
				create_country_leader = {
					name = "Anarchist Commune"
					desc = "POLITICS_ANARCHIST_COMMUNE_DESC"
					picture = "GFX_portrait_SPR_anarchist_commune"
					expire = "1965.1.1"
					ideology = anarchism
					traits = {
					}
				}
			}
			FROM = {
				country_event = { id = lar_spain.49 }
			}
		}
	}
}

# Portuguese Anarchism - Event for Spain
country_event = {
	id = lar_spain.49
	title = lar_spain.48.t
	desc = lar_spain.49.desc
	picture = GFX_report_event_spr_anarchist_uprising
	
	is_triggered_only = yes
	
	option = { # Ok
		name = lar_spain.49.a
		random_country = {
			limit = {
				original_tag = POR
				has_government = neutrality
				NOT = { tag = FROM }
			}
			SPC = {
				add_to_war = {
				    targeted_alliance = PREV 
				    enemy = POR
				    hostility_reason = asked_to_join
				}
				puppet = PREV
			}
			set_political_party = {
			    ideology = neutrality
			    popularity = 100
			}
		}
		POR ={
			set_rule = { can_join_factions = no	}
		}
	}
}

# Portuguese Anarchism - Event for Spain - Portuguese Civil War ends
country_event = {
	id = lar_spain.50
	title = lar_spain.50.t
	desc = lar_spain.50.desc
	picture = GFX_report_event_spr_anarchist_success
	
	is_triggered_only = yes
	
	option = { # Ok
		name = lar_spain.50.a
		random_country = {
			limit = {
				original_tag = POR
				has_government = neutrality
				is_subject_of = ROOT
			}
			SPC = {
				annex_country = {
				    target = PREV
				    transfer_troops = yes
				}
			}
		}
		clr_global_flag = SPR_portuguese_anarchism_flag
	}
}

# Relocate the Gold Reserves - Event for Spain - Choose target
country_event = {
	id = lar_spain.51
	title = lar_spain.51.t
	desc = lar_spain.51.desc
	picture = GFX_report_event_generic_read_write
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			random_other_country = {
				limit = {
					ROOT = {
						has_volunteers_amount_from = {
						    tag = PREV
						    count > 0
						}
					}
					NOT = { tag = SOV }
				}
				set_country_flag = SPR_relocated_gold_reserves_selection_flag1
				save_event_target_as = SPR_relocated_gold_reserves_selection_1
			}
			random_other_country = {
				limit = {
					ROOT = {
						has_volunteers_amount_from = {
						    tag = PREV
						    count > 0
						}
					}
					NOT = { tag = SOV }
					NOT = { has_country_flag = SPR_relocated_gold_reserves_selection_flag1 }
				}
				set_country_flag = SPR_relocated_gold_reserves_selection_flag2
				save_event_target_as = SPR_relocated_gold_reserves_selection_2
			}
			random_other_country = {
				limit = {
					ROOT = {
						has_volunteers_amount_from = {
						    tag = PREV
						    count > 0
						}
					}
					NOT = { tag = SOV }
					NOT = { has_country_flag = SPR_relocated_gold_reserves_selection_flag1 }
					NOT = { has_country_flag = SPR_relocated_gold_reserves_selection_flag2 }
				}
				set_country_flag = SPR_relocated_gold_reserves_selection_flag3
				save_event_target_as = SPR_relocated_gold_reserves_selection_3
			}
		}
	}
	
	option = { # Send to SOV
		name = lar_spain.51.a
		ai_chance = {
			base = 25
			modifier = {
				factor = 2
				has_volunteers_amount_from = {
				    tag = SOV
				    count > 0
				}
			}
		}
		trigger = {
			SOV = {
				exists = yes
				has_government = communism
			}
		}
		SOV = { set_country_flag = SPR_relocated_gold_reserves_selection_flag_sov }
		SOV = { country_event = { id = lar_spain.52 hours = 6 random_hours = 6 } }
	}
	option = { # Send to #1
		name = lar_spain.51.b
		ai_chance = {
			base = 25
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		trigger = {
			any_other_country = {
				has_country_flag = SPR_relocated_gold_reserves_selection_flag1
			}
		}
		event_target:SPR_relocated_gold_reserves_selection_1 = {
			country_event = { id = lar_spain.52 hours = 6 random_hours = 6 }
		}
	}
	option = { # Send to #2
		name = lar_spain.51.c
		ai_chance = {
			base = 25
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		trigger = {
			any_other_country = {
				has_country_flag = SPR_relocated_gold_reserves_selection_flag2
			}
		}
		event_target:SPR_relocated_gold_reserves_selection_2 = {
			country_event = { id = lar_spain.52 hours = 6 random_hours = 6 }
		}
	}
	option = { # Send to #3
		name = lar_spain.51.d
		ai_chance = {
			base = 25
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
		trigger = {
			any_other_country = {
				has_country_flag = SPR_relocated_gold_reserves_selection_flag3
			}
		}
		event_target:SPR_relocated_gold_reserves_selection_3 = {
			country_event = { id = lar_spain.52 hours = 6 random_hours = 6 }
		}
	}
}

# Relocate the Gold Reserves - Event for Target
country_event = {
	id = lar_spain.52
	title = lar_spain.52.t
	desc = lar_spain.52.desc
	picture = GFX_report_event_destroyers
	
	is_triggered_only = yes
	
	option = { # Ok
		name = lar_spain.52.a
		set_country_flag = { flag = SPR_relocate_the_gold_reserves_timer_flag value = 1 days = 60 }
	}
}

# Relocate the Gold Reserves - Event for Target - Seize the Gold
country_event = {
	id = lar_spain.53
	title = lar_spain.53.t
	desc = lar_spain.53.desc
	picture = GFX_report_event_generic_read_write
	
	fire_only_once = yes

	trigger = {
		any_country = {
			original_tag = SPR
			OR = {
				has_government = democratic
				has_government = communism
			}
			has_volunteers_amount_from = {
			    tag = ROOT
			    count > 0
			}
		}
		OR = {
			has_country_flag = SPR_relocated_gold_reserves_selection_flag_sov
			has_country_flag = SPR_relocated_gold_reserves_selection_flag1
			has_country_flag = SPR_relocated_gold_reserves_selection_flag2
			has_country_flag = SPR_relocated_gold_reserves_selection_flag3
		}
		NOT = { has_country_flag = SPR_relocate_the_gold_reserves_timer_flag }
	}

	mean_time_to_happen = {
		days = 30
	}
	
	option = { # Seize it!
		name = lar_spain.53.a
		ai_chance = {
			base = 50
		}
		add_political_power = -25
		add_timed_idea = { idea = SPR_seized_spanish_gold_reserves days = 365 }
		hidden_effect = {
			SPD = {
				country_event = { id = lar_spain.54 }
			}
		}
	}

	option = { # Let it go.
		name = lar_spain.53.b
		ai_chance = {
			base = 50
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
	}
}

# Relocate the Gold Reserves - Event for Spain - Gold seized!
country_event = {
	id = lar_spain.54
	title = lar_spain.54.t
	desc = lar_spain.54.desc
	picture = GFX_report_event_generic_read_write
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			remove_ideas = SPR_relocate_the_gold_reserves
			set_country_flag = SPR_seized_gold_reserves_flag
		}
	}
	
	option = { # Ok
		name = lar_spain.54.a
		effect_tooltip = { remove_ideas = SPR_relocate_the_gold_reserves }
		custom_effect_tooltip = lar_spain.54.a_tt
	}
}

# Relocate the Gold Reserves - Event for Spain - Payback time
country_event = {
	id = lar_spain.55
	title = lar_spain.55.t
	desc = lar_spain.55.desc
	picture = GFX_report_event_generic_read_write
	
	fire_only_once = yes

	trigger = {
		original_tag = SPR
		has_country_flag = SPR_seized_gold_reserves_flag
		has_global_flag = scw_over
	}

	mean_time_to_happen = {
		days = 2
	}
	
	option = { # Dangit
		name = lar_spain.55.a
		add_timed_idea = { idea = SPR_seized_spanish_gold_reserves_spain days = 365 }
	}
}

# Appeal for Increased Autonomy - Event for SOV
country_event = {
	id = lar_spain.56
	title = lar_spain.56.t
	desc = lar_spain.56.desc
	picture = GFX_report_event_generic_parliament
	
	is_triggered_only = yes
	
	option = { # Accept
		name = lar_spain.56.a
		end_puppet = FROM
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.57 }
			}
		}
	}

	option = { # Decline
		name = lar_spain.56.b
		ai_chance = {
			base = 0
		}
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.58 }
			}
		}
	}
}

# Appeal for Increased Autonomy - Event for Spain - SOV accepted
country_event = {
	id = lar_spain.57
	title = lar_spain.57.t
	desc = lar_spain.57.desc
	picture = GFX_report_event_generic_sign_treaty3
	
	is_triggered_only = yes
	
	option = { # Ok
		name = lar_spain.57.a
		effect_tooltip = {
			FROM = { end_puppet = ROOT }
		}
	}
}

# Appeal for Increased Autonomy - Event for Spain - SOV declined
country_event = {
	id = lar_spain.58
	title = lar_spain.58.t
	desc = lar_spain.58.desc
	picture = GFX_report_event_generic_sign_treaty2
	
	is_triggered_only = yes
	
	option = { # Damn
		name = lar_spain.58.a
	}
}

# A Red Iberia - Event for Portugal
country_event = {
	id = lar_spain.59
	title = lar_spain.59.t
	desc = lar_spain.59.desc
	picture = GFX_report_event_generic_parliament
	
	is_triggered_only = yes
	
	option = { # Accept
		name = lar_spain.59.a
		ai_chance = {
			base = 50
		}
		effect_tooltip = {
			FROM = {
				annex_country = { target = ROOT transfer_troops = yes }
			}
		}
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.60 }
			}
		}
		custom_effect_tooltip = GAME_OVER_TT
	}

	option = { # Decline
		name = lar_spain.59.b
		ai_chance = {
			base = 50
			modifier = {
				factor = 0.8
				strength_ratio = { tag = FROM ratio < 0.5 }
			}
			modifier = {
				factor = 0.8
				has_opinion = { target = FROM value > 99 }
			}
			modifier = {
				factor = 0.8
				strength_ratio = { tag = FROM ratio < 0.3 }
			}
			modifier = {
				factor = 0.8
				strength_ratio = { tag = FROM ratio < 0.2 }
			}
			modifier = {
				factor = 0
				strength_ratio = { tag = FROM ratio < 0.1 }
			}
			modifier = {
				factor = 0.8
				NOT = { has_war_with = FROM }
				has_war = yes
				surrender_progress > 0
			}
			modifier = {
				factor = 0.5
				NOT = { has_war_with = FROM }
				has_war = yes
				surrender_progress > 0.3
			}
			modifier = {
				factor = 0.5
				strength_ratio = { tag = FROM ratio < 0.2 }
			}
			modifier = {
				factor = 0
				NOT = { has_war_with = FROM }
				has_war = yes
				surrender_progress > 0.5
			}
		}
		effect_tooltip = {
			FROM = {
				create_wargoal = {
					type = annex_everything
					target = ROOT
				}
			}
		}
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.61 }
			}
		}
	}
}

# A Red Iberia - Event for Spain - Portugal Accepted
country_event = {
	id = lar_spain.60
	title = lar_spain.60.t
	desc = lar_spain.60.desc
	picture = GFX_report_event_generic_sign_treaty3
	
	is_triggered_only = yes
	
	option = { # Ok
		name = lar_spain.60.a
		set_cosmetic_tag = ESU_POR_unified
		every_state = {
			limit = {
				is_core_of = POR
			}
			add_core_of = ROOT
		}
		annex_country = { target = FROM transfer_troops = yes }
	}
}

# A Red Iberia - Event for Spain - Portugal Declined
country_event = {
	id = lar_spain.61
	title = lar_spain.61.t
	desc = lar_spain.61.desc
	picture = GFX_report_event_generic_sign_treaty2
	
	is_triggered_only = yes
	
	option = { # Damn
		name = lar_spain.61.a
		create_wargoal = {
			type = annex_everything
			target = FROM
		}
	}
}

# Support French Communists - Event for France
country_event = {
	id = lar_spain.62
	title = lar_spain.62.t
	desc = lar_spain.62.desc
	picture = GFX_report_event_generic_riot
	
	is_triggered_only = yes
	
	option = { # Ok :'(
		name = lar_spain.62.a
		hidden_effect = {
			if = {
				limit = {
					communism > 0.4
				}
				start_civil_war = {
				    ideology = communism
				    size = 0.3
				    keep_unit_leaders_trigger = {
				    	always = yes
				    }
				}
			}
			else_if = {
				limit = {
					communism > 0.3
				}
				start_civil_war = {
				    ideology = communism
				    size = 0.2
				    keep_unit_leaders_trigger = {
				    	always = yes
				    }
				}
			}
			else = {
				start_civil_war = {
				    ideology = communism
				    size = 0.1
				    keep_unit_leaders_trigger = {
				    	always = yes
				    }
				}
			}
			FROM = {
				country_event = { id = lar_spain.63 }
			}
		}
	}
}

# Support French Communists - Event for Spain
country_event = {
	id = lar_spain.63
	title = lar_spain.63.t
	desc = lar_spain.63.desc
	picture = GFX_report_event_generic_riot
	
	is_triggered_only = yes
	
	option = { # Ok
		name = lar_spain.63.a
		random_country = {
			limit = {
				original_tag = FRA
				has_government = communism
				NOT = { tag = FROM }
			}
			SPR = {
				puppet = PREV
				add_to_war = { 
				    targeted_alliance = PREV
				    enemy = FRA
				    hostility_reason = asked_to_join
				}
			}
		}
	}
}

# Petition for French Aid - Event for France
country_event = {
	id = lar_spain.64
	title = lar_spain.64.t
	desc = lar_spain.64.desc
	picture = GFX_report_event_spr_no_pasaran
	
	is_triggered_only = yes
	
	option = { # Accept
		name = lar_spain.64.a
		ai_chance = {
			base = 50
			modifier = {
				factor = 0.5
				is_historical_focus_on = yes
			}
			modifier = {
				factor = 0.2
				has_country_flag = FRA_non_intervention
			}
		}
		add_political_power = -50
		add_popularity = {
			ideology = communism
			popularity = 0.1
		}
		add_timed_idea = { idea = SPR_equipment_shipments days = 730 }
		add_opinion_modifier = { target = FROM modifier = SPA_spanish_civil_war_commitments }
		FROM = {
			add_war_support = 0.15
		}
		add_ai_strategy = { type = send_lend_lease_desire id = SPR value = 100 }
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.65 }
			}
		}
	}

	option = { # Decline
		name = lar_spain.64.b
		ai_chance = {
			base = 50
			modifier = {
				factor = 0
				OR = {
					has_country_flag = FRA_arms_purchases_allowed
					has_country_flag = FRA_sending_weapons_allowed
					has_country_flag = FRA_volunteer_work_allowed
				}
			}
		}
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.66 }
			}
		}
	}
}

# Petition for French Aid - Event for Spain - France Accepted
country_event = {
	id = lar_spain.65
	title = lar_spain.65.t
	desc = lar_spain.65.desc
	picture = GFX_report_event_spr_no_pasaran
	
	is_triggered_only = yes
	option = { # Ok
		name = lar_spain.65.a
		effect_tooltip = { FROM = { add_opinion_modifier = { target = ROOT modifier = SPA_spanish_civil_war_commitments } } }
		add_war_support = 0.15
	}
}

# Petition for French Aid - Event for Spain - France Declined
country_event = {
	id = lar_spain.66
	title = lar_spain.66.t
	desc = lar_spain.66.desc
	picture = GFX_report_event_generic_read_write
	
	is_triggered_only = yes
	
	option = { # Damn
		name = lar_spain.66.a
	}
}

# War of Independence - Event for SOV
country_event = {
	id = lar_spain.67
	title = lar_spain.67.t
	desc = lar_spain.67.desc
	picture = GFX_report_event_generic_parliament
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			end_puppet = FROM
			remove_from_faction = FROM
		}
	}
	
	option = { # Ok
		name = lar_spain.67.a
		ai_chance = {
			base = 100
			modifier = {
				factor = 0.33
				any_country = {
					is_major = yes
					has_war_with = ROOT
				}
			}
			modifier = {
				factor = 0
				surrender_progress > 0.1
			}
		}
		effect_tooltip = {
			end_puppet = FROM
			remove_from_faction = FROM
		}
		FROM = {
			declare_war_on = {
			    target = ROOT
			    type = topple_government
			}
		}
		hidden_effect = { FROM = { news_event = { id = lar_news.20 hours = 6 } } }
	}

	option = { # Let them have their independence
		name = lar_spain.67.b
		ai_chance = {
			base = 0
			modifier = {
				add = 100
				any_country = {
					is_major = yes
					has_war_with = ROOT
				}
			}
			modifier = {
				add = 100
				has_country_flag = SOV_give_them_independence_flag
			}
		}
		effect_tooltip = {
			end_puppet = FROM
			remove_from_faction = FROM
		}
		delete_unit_template_and_units = {
			division_template = "Spanish Loyalist Division"
		}
		if = {
			limit = {
				has_country_flag = SOV_annexed_spanish_land
			}
			FROM = {
				transfer_state = 165
				transfer_state = 167
				transfer_state = 794
			}
		}
		FROM = { country_event = lar_spain.89 }
	}
}

# Those Who Would Not Help Us - Event for USA/ENG/FRA
country_event = {
	id = lar_spain.68
	title = lar_spain.68.t
	desc = lar_spain.68.desc
	picture = GFX_report_event_generic_read_write
	
	is_triggered_only = yes
	
	option = { # Accept
		name = lar_spain.68.a
		ai_chance = {
			base = 75
		}
		add_timed_idea = { idea = SPR_equipment_shipments days = 730 }
		add_ai_strategy = { type = send_lend_lease_desire id = SPR value = 100 }
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.69 }
			}
		}
	}

	option = { # Decline
		name = lar_spain.68.b
		ai_chance = {
			base = 25
			modifier = {
				factor = 0.5
				has_opinion = { target = FROM value > 99 }
			}
			modifier = {
				factor = 0
				has_war_with = SOV
			}
		}
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.70 }
			}
		}
	}
}

# Those Who Would Not Help Us - Event for Spain - FROM Accepted
country_event = {
	id = lar_spain.69
	title = lar_spain.69.t
	desc = lar_spain.69.desc
	picture = GFX_report_event_generic_sign_treaty1
	
	is_triggered_only = yes
	
	option = { # Ok
		name = lar_spain.69.a
		effect_tooltip = {
			FROM = { add_timed_idea = { idea = SPR_equipment_shipments days = 730 } }
		}
	}
}

# Those Who Would Not Help Us - Event for Spain - FROM Declined
country_event = {
	id = lar_spain.70
	title = lar_spain.70.t
	desc = lar_spain.70.desc
	picture = GFX_report_event_generic_read_write
	
	is_triggered_only = yes
	
	option = { # Damn
		name = lar_spain.70.a
	}
}

# Enemies of Our Enemy - Event for GER/ITA
country_event = {
	id = lar_spain.71
	title = lar_spain.71.t
	desc = lar_spain.71.desc
	picture = GFX_report_event_generic_parliament
	
	is_triggered_only = yes
	
	option = { # Accept
		name = lar_spain.71.a
		ai_chance = {
			base = 75
		}
		diplomatic_relation = {
		    country = FROM
		    relation = non_aggression_pact
		    active = yes
		}
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.72 }
			}
		}
	}

	option = { # Decline
		name = lar_spain.71.b
		ai_chance = {
			base = 25
			modifier = {
				factor = 0.5
				has_opinion = { target = FROM value > 99 }
			}
			modifier = {
				factor = 0
				has_war_with = SOV
			}
		}
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.73 }
			}
		}
	}
}

# Enemies of Our Enemy - Event for Spain - FROM Accepted
country_event = {
	id = lar_spain.72
	title = lar_spain.72.t
	desc = lar_spain.72.desc
	picture = GFX_report_event_generic_sign_treaty3
	
	is_triggered_only = yes
	
	option = { # Ok
		name = lar_spain.72.a
		effect_tooltip = {
			FROM = {
				diplomatic_relation = {
				    country = ROOT
				    relation = non_aggression_pact
				    active = yes
				}
			}
		}
	}
}

# Enemies of Our Enemy - Event for Spain - FROM Declined
country_event = {
	id = lar_spain.73
	title = lar_spain.73.t
	desc = lar_spain.73.desc
	picture = GFX_report_event_generic_read_write
	
	is_triggered_only = yes
	
	option = { # Damn
		name = lar_spain.73.a
	}
}

# Enemies of Our Enemy - Event for GER
country_event = {
	id = lar_spain.74
	title = lar_spain.74.t
	desc = lar_spain.74.desc
	picture = GFX_report_event_generic_parliament
	
	is_triggered_only = yes
	
	option = { # Accept
		name = lar_spain.74.a
		ai_chance = {
			base = 75
		}
		army_experience = -25
		effect_tooltip = {
			FROM = {
				add_timed_idea = { idea = SPR_deal_with_the_devil days = 730 }
			}
		}
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.75 }
			}
		}
	}

	option = { # Decline
		name = lar_spain.74.b
		ai_chance = {
			base = 25
			modifier = {
				factor = 0.5
				has_opinion = { target = FROM value > 99 }
			}
			modifier = {
				factor = 0
				has_war_with = SOV
			}
		}
		hidden_effect = {
			FROM = {
				country_event = { id = lar_spain.76 }
			}
		}
	}
}

# Enemies of Our Enemy - Event for Spain - FROM Accepted
country_event = {
	id = lar_spain.75
	title = lar_spain.75.t
	desc = lar_spain.75.desc
	picture = GFX_report_event_generic_sign_treaty2
	
	is_triggered_only = yes
	
	option = { # Ok
		name = lar_spain.75.a
		add_timed_idea = { idea = SPR_deal_with_the_devil days = 730 }
	}
}

# Enemies of Our Enemy - Event for Spain - FROM Declined
country_event = {
	id = lar_spain.76
	title = lar_spain.76.t
	desc = lar_spain.76.desc
	picture = GFX_report_event_generic_read_write
	
	is_triggered_only = yes
	
	option = { # Damn
		name = lar_spain.76.a
	}
}

# Spain - Alfonso Dies
country_event = {
	id = lar_spain.77
	title = lar_spain.77.t
	desc = {
		text = lar_spain.77.desc1
		trigger = {

			NOT = { has_country_flag = SPB_xavier_king }
		}
	}
	desc = {
		text = lar_spain.77.desc2
		trigger = {
			NOT = {
				AND = {
					NOT = { has_country_flag = SPB_xavier_king }
				}
			}
		}
	}
	picture = GFX_report_event_europe_funeral
	
	trigger = {
		original_tag = SPR
		if = {
			limit = {
				any_country = {
					OR = {
						AND = {
							tag = SPA
						}
						tag = SPB
					}
					is_ai = no
				}
			}
			is_ai = no
		}
		
		NOT = { has_global_flag = SPB_alfonso_xiii_dead }
		date > 1940.2.28
	}

	mean_time_to_happen = {
		days = 365
	}

	fire_only_once = yes

	immediate = {
		hidden_effect = {
			set_global_flag = SPB_alfonso_xiii_dead
			if = {
				limit = {
					has_country_leader = {
					    name = "Alfonso XIII"
					    ruling_only = yes
					}
				}
				kill_country_leader = yes
				create_country_leader = {
					name = "Jaime IV"
					desc = "POLITICS_JAIME_IV_DESC"
					picture = "GFX_portrait_fra_infante_jaime"
					expire = "1965.1.1"
					ideology = despotism
					traits = {
						
					}
				}
			}
		}
	}
	
	option = { # RIP
		name = lar_spain.77.a
		if = {
			limit = {
				has_country_leader = {
				    name = "Alfonso XIII"
				    ruling_only = yes
				}
			}
			effect_tooltip = {
				kill_country_leader = yes
				create_country_leader = {
					name = "Jaime IV"
					desc = "POLITICS_JAIME_IV_DESC"
					picture = "GFX_portrait_fra_infante_jaime"
					expire = "1965.1.1"
					ideology = despotism
					traits = {
						
					}
				}
			}
		}
	}
}

# Spain - Sanjurjo Dies
country_event = {
	id = lar_spain.78
	title = lar_spain.78.t
	desc = lar_spain.78.desc
	picture = GFX_report_event_spr_plane_crash
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			kill_country_leader = yes
			create_country_leader = {
				name = "Military Junta"
				desc = "POLITICS_MILITARY_JUNTA_DESC"
				picture = "GFX_portrait_SPA_military_junta"
				expire = "1965.1.1"
				ideology = despotism
				traits = {
					divided_interests
				}
			}
		}
	}
	
	option = { # RIP
		name = lar_spain.78.a
		effect_tooltip = {
			custom_effect_tooltip = lar_spain.78_tt
			hidden_effect = {
				kill_country_leader = yes
			}
			create_country_leader = {
				name = "Military Junta"
				desc = "POLITICS_MILITARY_JUNTA_DESC"
				picture = "GFX_portrait_SPA_military_junta"
				expire = "1965.1.1"
				ideology = despotism
				traits = {
					divided_interests
				}
			}
		}
	}
}

# Claim the French Throne - Event for Spain - Coronation
country_event = {
	id = lar_spain.79
	title = lar_spain.79.t
	desc = lar_spain.79.desc
	picture = GFX_report_event_royal_parade
	
	is_triggered_only = yes
	
	option = { # Ok
		name = lar_spain.79.a
		FRA = {
			every_unit_leader = {
				set_nationality = ROOT
			}
		}
		every_state = {
			limit = {
				is_core_of = FRA
			}
			add_core_of = ROOT
		}
		annex_country = { target = FRA transfer_troops = yes }
	}
}

# Hidden event to 'age' Franco after 1950
country_event = {
	id = lar_spain.80

	trigger = {
		tag = SPA
		date > 1950.1.1
	}

	mean_time_to_happen = {
		days = 2
	}

	fire_only_once = yes

	hidden = yes

	immediate = {
		hidden_effect = {
			SPA_francisco_franco = {
				set_portraits = {
					civilian = { large =  GFX_portrait_spain_francisco_franco_old }
				}
			}
		}
	}
}

# End of SCW, Republicans expanded Soviet aid - event for SOV
country_event = {
	id = lar_spain.81
	title = lar_spain.81.t
	desc = lar_spain.81.desc
	picture = GFX_report_event_generic_parliament
	
	is_triggered_only = yes
	
	option = { # Ok
		name = lar_spain.81.a
		effect_tooltip = {
			puppet = SPD
		}
	}
}

# End of SCW, Republicans expanded Soviet aid - event for SPD
country_event = {
	id = lar_spain.82
	title = lar_spain.82.t
	desc = lar_spain.82.desc
	picture = GFX_report_event_generic_parliament
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			if = {
				limit = {
					has_government = democratic
				}
				set_country_flag = SPR_democratic_government_flag
			}
			set_temp_variable = {
				var = soviet_puppet_democratic_var
				value = party_popularity@democratic
			}
			SOV = { puppet = SPD }
			if = {
				limit = {
					has_country_flag = SPR_democratic_government_flag
				}
				set_politics = {
					ruling_party = democratic
				}
				clr_country_flag = SPR_democratic_government_flag
			}
			set_political_party = {
			    ideology = communism
			    popularity = 100
			}
			add_popularity = {
			    ideology = democratic
			    popularity = soviet_puppet_democratic_var
			}
		}
	}
	
	option = { # Ok
		name = lar_spain.82.a
		effect_tooltip = {
			SOV = { puppet = SPD }
		}
	}
}


# Event for SPR that Soviets are seizing land
country_event = {
	id = lar_spain.84
	title = lar_spain.84.t
	desc = lar_spain.84.desc
	picture = GFX_report_event_soviet_army_greeted

	is_triggered_only = yes

	option = { # Bastards!
		name = lar_spain.84.a
		set_country_flag = SOV_took_spanish_states
		effect_tooltip = {
			SOV = {
				transfer_state = 165
				transfer_state = 167
				transfer_state = 794
			}
		}
	}
}

# SPR has Catalonia returned
country_event = {
	id = lar_spain.85
	title = lar_spain.85.t
	desc = lar_spain.85.desc
	picture = GFX_report_event_soldiers_marching

	trigger = {
		tag = SPD
		has_country_flag = SOV_took_spanish_states
		has_war_with = SOV
		SOV = { owns_state = 165 }
		has_full_control_of_state = 165
	}

	mean_time_to_happen = {
		days = 2
	}

	fire_only_once = yes

	immediate = {
		hidden_effect = {
			165 = { save_event_target_as = SPR_stolen_state_name }
		}
	}

	option = { # Excellent!
		name = lar_spain.85.a
		transfer_state = 165
		hidden_effect = { SOV = { country_event = { id = lar_spain.88 } } }
	}
}

# SPR has Valencia returned
country_event = {
	id = lar_spain.86
	title = lar_spain.85.t
	desc = lar_spain.85.desc
	picture = GFX_report_event_soldiers_marching

	trigger = {
		tag = SPD
		has_country_flag = SOV_took_spanish_states
		has_war_with = SOV
		SOV = { owns_state = 167 }
		has_full_control_of_state = 167
	}

	mean_time_to_happen = {
		days = 2
	}

	fire_only_once = yes

	immediate = {
		hidden_effect = {
			167 = { save_event_target_as = SPR_stolen_state_name }
		}
	}

	option = { # Excellent!
		name = lar_spain.85.a
		transfer_state = 167
		hidden_effect = { SOV = { country_event = { id = lar_spain.88 } } }
	}
}

# SPR has Eastern Aragon returned
country_event = {
	id = lar_spain.87
	title = lar_spain.85.t
	desc = lar_spain.85.desc
	picture = GFX_report_event_soldiers_marching

	trigger = {
		tag = SPD
		has_country_flag = SOV_took_spanish_states
		has_war_with = SOV
		SOV = { owns_state = 794 }
		has_full_control_of_state = 794
	}

	mean_time_to_happen = {
		days = 2
	}

	fire_only_once = yes

	immediate = {
		hidden_effect = {
			794 = { save_event_target_as = SPR_stolen_state_name }
		}
	}

	option = { # Excellent!
		name = lar_spain.85.a
		transfer_state = 794
		hidden_effect = { SOV = { country_event = { id = lar_spain.88 } } }
	}
}

# Event for SOV informing them of losing a state to SPR
country_event = {
	id = lar_spain.88
	title = lar_spain.88.t
	desc = lar_spain.88.desc
	picture = GFX_report_event_soldiers_marching

	is_triggered_only = yes

	option = { # Excellent!
		name = lar_spain.88.a
		effect_tooltip = { FROM = { transfer_state = event_target:SPR_stolen_state_name } }
	}
}

# Event for SPR that Soviets are giving them independence
country_event = {
	id = lar_spain.89
	title = lar_spain.89.t
	desc = lar_spain.89.desc
	picture = GFX_report_event_soviet_army_greeted

	is_triggered_only = yes

	option = { # Ok
		name = lar_spain.89.a
		if = {
			limit = {
				SOV = { has_country_flag = SOV_annexed_spanish_land }
			}
			SOV = { clr_country_flag = SOV_annexed_spanish_land }
			effect_tooltip = {
				FROM = {
					transfer_state = 165
					transfer_state = 167
					transfer_state = 794
				}
			}
		}
	}
}

# Event for Spain that the president is dismissed
country_event = {
	id = lar_spain.90
	title = lar_spain.90.t
	desc = lar_spain.90.desc
	picture = GFX_report_event_generic_parliament

	trigger = {
		tag = SPR
		date > 1936.4.20
		NOT = { has_global_flag = spanish_civil_war }
	}

	mean_time_to_happen = {
		days = 2
	}

	fire_only_once = yes

	option = { # Ok
		name = lar_spain.90.a
		if = {
			limit = {
				has_dlc = "La Resistance"
			}
			if = {
				limit = {
					
				}
				remove_ideas = SPR_government_power_struggle
				add_political_power = 10
			}
			retire_country_leader = yes
			create_country_leader = {
				name = "Manuel Azaña"
				desc = "POLITICS_MANUEL_AZANA_DESC"
				picture = GFX_portrait_Manuel_Azana
				expire = "1965.1.1"
				ideology = conservatism
				traits = {
					figurehead_president
				}
			}
		}
		else = {
			retire_country_leader = yes
			create_country_leader = {
				name = "Manuel Azaña"
				desc = "POLITICS_MANUEL_AZANA_DESC"
				picture = GFX_portrait_Manuel_Azana
				expire = "1965.1.1"
				ideology = conservatism
				traits = {
		
				}
			}
		}
	}
}
